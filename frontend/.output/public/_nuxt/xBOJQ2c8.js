import{_ as $}from"./CTTM8a4Y.js";import{q as f,c as r,o as l,F as C,m as B,s as S,w as a,d as c,t as u,r as v,g as D,a as t,k as y,b as o,v as U,x as A,j as F,p as q}from"./CXJKphkF.js";import{u as z}from"./B6j7ZqBZ.js";const E={key:0,class:"flex flex-wrap gap-1"},K={key:1,class:"text-xs text-gray-400"},R={__name:"TagDisplay",props:{tags:{type:Array,default:()=>[]}},setup(_){return(g,m)=>{const d=f("Badge");return _.tags&&_.tags.length>0?(l(),r("div",E,[(l(!0),r(C,null,B(_.tags,x=>(l(),S(d,{key:x,variant:"outline",class:"text-xs"},{default:a(()=>[c(u(x),1)]),_:2},1024))),128))])):(l(),r("div",K," No tags "))}}},O={class:"min-h-screen bg-gray-50"},P={class:"bg-white shadow-sm border-b"},Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},G={class:"flex justify-between items-center h-16"},H={class:"flex items-center space-x-4"},J={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},W={class:"mb-8"},X={class:"max-w-2xl mx-auto"},Y={class:"flex space-x-4"},Z={key:0,class:"mb-8"},tt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"},et=["src","alt"],st={class:"p-4"},ot={class:"font-medium text-foreground truncate"},at={class:"flex items-center justify-between mt-2"},lt={class:"mt-3"},nt={key:1,class:"text-center py-12"},it={class:"p-6"},rt={class:"flex justify-between items-start mb-4"},dt={class:"text-lg font-semibold"},ct=["src","alt"],ut={class:"mt-4 text-sm text-gray-600"},mt={class:"mt-3"},ft={__name:"index",setup(_){const g=v(""),m=v([]),d=v(!1),x=v(!1),n=v(null),{apiCall:j}=z(),b=async()=>{if(g.value.trim()){d.value=!0,x.value=!0;try{const s=await j("/api/search",{method:"POST",body:{query:g.value}});m.value=s.results||[]}catch(s){console.error("Search error:",s),m.value=[]}finally{d.value=!1}}},N=s=>`${q().public.apiBase}/uploads/${s}`,T=s=>{n.value=s},w=()=>{n.value=null},I=async()=>{try{const{$auth:s}=F();s&&typeof s.removeToken=="function"&&s.removeToken(),window.location.reload()}catch(s){console.error("Logout error:",s)}};return D(async()=>{}),(s,e)=>{const p=f("Button"),h=$,L=f("Input"),M=f("Badge"),k=R,V=f("Card");return l(),r("div",O,[t("header",P,[t("div",Q,[t("div",G,[e[6]||(e[6]=t("div",{class:"flex items-center"},[t("h1",{class:"text-xl font-semibold text-gray-900"},"Eccentric Car Meta")],-1)),t("div",H,[o(h,{to:"/admin"},{default:a(()=>[o(p,{variant:"ghost"},{default:a(()=>[...e[2]||(e[2]=[c("Admin",-1)])]),_:1})]),_:1}),o(h,{to:"/login"},{default:a(()=>[o(p,{variant:"ghost"},{default:a(()=>[...e[3]||(e[3]=[c("Login",-1)])]),_:1})]),_:1}),o(p,{variant:"ghost",onClick:I},{default:a(()=>[...e[4]||(e[4]=[c("Logout",-1)])]),_:1}),o(h,{to:"/shadcn-test"},{default:a(()=>[o(p,{variant:"outline",size:"sm"},{default:a(()=>[...e[5]||(e[5]=[c("UI Test",-1)])]),_:1})]),_:1})])])])]),t("main",J,[t("div",W,[t("div",X,[e[7]||(e[7]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"Search Images",-1)),t("div",Y,[o(L,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=i=>g.value=i),type:"text",placeholder:"Describe what you're looking for...",class:"flex-1",onKeyup:U(b,["enter"])},null,8,["modelValue"]),o(p,{onClick:b,disabled:d.value},{default:a(()=>[c(u(d.value?"Searching...":"Search"),1)]),_:1},8,["disabled"])])])]),m.value.length>0?(l(),r("div",Z,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Search Results",-1)),t("div",tt,[(l(!0),r(C,null,B(m.value,i=>(l(),S(V,{key:i.id,class:"overflow-hidden cursor-pointer hover:shadow-md transition-shadow",onClick:gt=>T(i)},{default:a(()=>[t("img",{src:N(i.filename),alt:i.filename,class:"w-full h-48 object-cover"},null,8,et),t("div",st,[t("h4",ot,u(i.filename),1),t("div",at,[e[8]||(e[8]=t("p",{class:"text-sm text-muted-foreground"},"Similarity:",-1)),o(M,{variant:"secondary"},{default:a(()=>[c(u((i.similarity*100).toFixed(1))+"%",1)]),_:2},1024)]),t("div",lt,[o(k,{tags:i.tags||[]},null,8,["tags"])])])]),_:2},1032,["onClick"]))),128))])])):y("",!0),!d.value&&m.value.length===0&&x.value?(l(),r("div",nt,[...e[10]||(e[10]=[t("p",{class:"text-gray-500"},"No images found matching your search.",-1)])])):y("",!0)]),n.value?(l(),r("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:w},[t("div",{class:"bg-white rounded-lg max-w-4xl max-h-[90vh] overflow-hidden",onClick:e[1]||(e[1]=A(()=>{},["stop"]))},[t("div",it,[t("div",rt,[t("h3",dt,u(n.value.filename),1),t("button",{onClick:w,class:"text-gray-400 hover:text-gray-600"},[...e[11]||(e[11]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("img",{src:n.value.url,alt:n.value.filename,class:"max-w-full max-h-[70vh] object-contain mx-auto"},null,8,ct),t("div",ut,[t("p",null,"Similarity Score: "+u((n.value.similarity*100).toFixed(1))+"%",1),t("p",null,"Uploaded: "+u(new Date(n.value.uploadedAt).toLocaleDateString()),1),t("div",mt,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Tags:",-1)),o(k,{tags:n.value.tags||[]},null,8,["tags"])])])])])])):y("",!0)])}}};export{ft as default};
