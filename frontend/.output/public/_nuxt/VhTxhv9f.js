import{_ as T}from"./CTTM8a4Y.js";import{_ as U}from"./BIRvVTZw.js";import{u as $}from"./B6j7ZqBZ.js";import{r,g as D,j as f,n as v,c as l,a as e,b as y,w as L,k as A,t as u,l as B,F as N,m as S,o as n,d as j,p as E}from"./CXJKphkF.js";const F={class:"min-h-screen bg-gray-50"},M={class:"bg-white shadow-sm border-b"},V={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},H={class:"flex justify-between items-center h-16"},P={class:"flex items-center space-x-4"},z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},O={class:"mb-8"},R={class:"bg-white rounded-lg shadow-sm border p-6 mb-8"},q={class:"border-2 border-dashed border-gray-300 rounded-lg p-6"},G={class:"text-center"},J={class:"mt-4"},K={key:0,class:"mt-4"},Q={class:"flex items-center justify-between text-sm text-gray-600 mb-2"},W={class:"w-full bg-gray-200 rounded-full h-2"},X={class:"bg-white rounded-lg shadow-sm border"},Y={class:"p-6"},Z={key:0,class:"text-center py-8 text-gray-500"},ee={key:1,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"},te=["src","alt"],se={class:"p-4"},oe={class:"font-medium text-gray-900 truncate"},ae={class:"text-sm text-gray-600"},le={class:"mt-3"},ne=["onClick"],ue={__name:"admin",setup(re){const i=r([]),g=r(!1),d=r(0),c=r(0),p=r(0),{apiCall:m}=$(),h=async()=>{try{const s=await m("/api/images");i.value=s.images||[]}catch(s){console.error("Error loading images:",s)}},_=async s=>{const t=Array.from(s.target.files);t.length!==0&&await b(t)},b=async s=>{g.value=!0,d.value=0,c.value=0,p.value=s.length;try{for(let t=0;t<s.length;t++){const a=new FormData;a.append("image",s[t]),await m("/api/upload",{method:"POST",body:a}),c.value++,d.value=(t+1)/s.length*100}await h()}catch(t){console.error("Upload error:",t)}finally{g.value=!1,d.value=0,c.value=0,p.value=0}},w=async s=>{if(confirm("Are you sure you want to delete this image?"))try{await m(`/api/images/${s}`,{method:"DELETE"}),await h()}catch(t){console.error("Delete error:",t)}},k=(s,t)=>{const a=i.value.find(o=>o.id===s);a&&(a.tags=t)},C=s=>`${E().public.apiBase}/uploads/${s}`,I=async()=>{try{const{$auth:s}=f();s.removeToken(),await v("/login")}catch(s){console.error("Logout error:",s)}};return D(async()=>{try{const{$auth:s}=f();if(!s.getToken()){await v("/login");return}await m("/api/auth/verify"),await h()}catch{await v("/login")}}),(s,t)=>{const a=T;return n(),l("div",F,[e("header",M,[e("div",V,[e("div",H,[t[2]||(t[2]=e("div",{class:"flex items-center"},[e("h1",{class:"text-xl font-semibold text-gray-900"},"Admin Panel")],-1)),e("div",P,[y(a,{to:"/",class:"text-gray-600 hover:text-gray-900"},{default:L(()=>[...t[1]||(t[1]=[j("Home",-1)])]),_:1}),e("button",{onClick:I,class:"text-gray-600 hover:text-gray-900"},"Logout")])])])]),e("main",z,[e("div",O,[t[8]||(t[8]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"Image Management",-1)),e("div",R,[t[6]||(t[6]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Upload Images",-1)),e("div",q,[e("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",onChange:_,class:"hidden"},null,544),e("div",G,[t[4]||(t[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[e("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("div",J,[e("button",{onClick:t[0]||(t[0]=o=>s.$refs.fileInput.click()),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"}," Select Images "),t[3]||(t[3]=e("p",{class:"mt-2 text-sm text-gray-500"},"or drag and drop images here (up to 100 images)",-1))])])]),g.value?(n(),l("div",K,[e("div",Q,[t[5]||(t[5]=e("span",null,"Uploading...",-1)),e("span",null,u(c.value)+" / "+u(p.value),1)]),e("div",W,[e("div",{class:"bg-blue-600 h-2 rounded-full",style:B({width:d.value+"%"})},null,4)])])):A("",!0)]),e("div",X,[t[7]||(t[7]=e("div",{class:"p-6 border-b"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"All Images")],-1)),e("div",Y,[i.value.length===0?(n(),l("div",Z," No images uploaded yet. ")):(n(),l("div",ee,[(n(!0),l(N,null,S(i.value,o=>(n(),l("div",{key:o.id,class:"border rounded-lg overflow-hidden hover:shadow-md transition-shadow"},[e("img",{src:C(o.filename),alt:o.filename,class:"w-full h-48 object-cover"},null,8,te),e("div",se,[e("h4",oe,u(o.filename),1),e("p",ae,"Uploaded: "+u(new Date(o.uploadedAt).toLocaleDateString()),1),e("div",le,[y(U,{"image-id":o.id,"initial-tags":o.tags||[],onTagsUpdated:x=>k(o.id,x)},null,8,["image-id","initial-tags","onTagsUpdated"])]),e("button",{onClick:x=>w(o.id),class:"mt-3 text-sm text-red-600 hover:text-red-800"}," Delete ",8,ne)])]))),128))]))])])])])])}}};export{ue as default};
